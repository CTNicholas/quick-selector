{"version":3,"file":"qs.modern.js","sources":["../src/index.js"],"sourcesContent":["/*\r\n *\r\n */\r\n\r\n\r\nconst addTemplate = createTemplate()\r\n\r\nmodule.exports = function (literals, ...substitutions) {\r\n  const query = createQuery(literals, substitutions)\r\n  if (query === null) return null\r\n  if (Array.isArray(query)) {\r\n    return addTemplate(query)\r\n  } else {\r\n    const elements = Array.from(document.querySelectorAll(query))\r\n    return elements.length > 0 ? addTemplate(elements) : null\r\n  }\r\n}\r\n\r\nfunction createTemplate () {\r\n  const events = getAllEvents()\r\n  const customMethods = {\r\n    set: setFunction,\r\n    get: getFunction\r\n  }\r\n  return function (elements) {\r\n    const customProps = {}\r\n    events.forEach(event => {\r\n      addAFunction(customProps, event, eventFunction, { elements, event })\r\n    })\r\n    Object.entries(customMethods).forEach(([methodName, methodFunc]) => {\r\n      addAFunction(customProps, methodName, methodFunc, { elements })\r\n    })\r\n    return Object.defineProperties(elements, customProps)\r\n  }\r\n}\r\n\r\nfunction addAFunction (customProps, propName, propFunc, funcVars) {\r\n  customProps[propName] = {}\r\n  customProps[propName].value = propFunc(funcVars)\r\n}\r\n\r\n/*\r\n * The next functions are all non-enumerable properties given to the created qs objects\r\n */\r\nfunction eventFunction ({ elements, event }) {\r\n  return function (func) {\r\n    elements.forEach(element => {\r\n      element.addEventListener(event, (jsEvent) => {\r\n        func (jsEvent, elements)\r\n      })\r\n    })\r\n    return elements\r\n  }\r\n}\r\n\r\nfunction setFunction ({ elements }) {\r\n  return function (func) {\r\n    elements.forEach(func)\r\n    return elements\r\n  }\r\n}\r\n\r\nfunction getFunction ({ elements }) {\r\n  return function (func) {\r\n    return elements.map(element => func(element))\r\n  }\r\n}\r\n\r\n/* \r\n * Returns an array of names of all available events\r\n */\r\nfunction getAllEvents () {\r\n  return Object.getOwnPropertyNames(Object.getPrototypeOf(Object.getPrototypeOf(document))).filter(eventName =>\r\n    !eventName.indexOf('on') && (document[eventName] == null || typeof document[eventName] == 'function')\r\n  ).map(eventName => eventName.substr(2))\r\n}\r\n\r\n/*\r\n * Takes arguments from a tagged template literal\r\n * If valid HTML element array submitted as first argument, return\r\n * Else If array entered as a substitution, and no literals, return substitution array\r\n * Else If return a query string to be used with document.querySelectorAll\r\n * If not valid, return null\r\n */\r\nfunction createQuery (literals, substitutions) {\r\n  console.log('here', literals, substitutions, substitutions.length, Array.isArray(substitutions))\r\n  if (Array.isArray(literals) && literals.every(isValidElement)) {\r\n    return literals\r\n  } else if (Array.isArray(literals) && Array.isArray(substitutions)) {\r\n    if (literals.join() === '' && substitutions.every(isValidElement)) {\r\n      return substitutions\r\n    } else {\r\n      return literals.map((literal, index) => {\r\n        return (literal || '') + (substitutions[index] || '')\r\n      }).join() || null\r\n    }\r\n  } else if (typeof literals === 'string' || literals instanceof String) {\r\n    return literals\r\n  } else {\r\n    return null\r\n  }\r\n}\r\n\r\nfunction isValidElement (element) {\r\n  return element instanceof Element || element instanceof HTMLDocument\r\n}"],"names":["addTemplate","events","Object","getOwnPropertyNames","getPrototypeOf","document","filter","eventName","indexOf","map","substr","customMethods","set","setFunction","get","getFunction","elements","customProps","forEach","event","addAFunction","eventFunction","entries","methodName","methodFunc","defineProperties","createTemplate","propName","propFunc","funcVars","value","func","element","addEventListener","jsEvent","isValidElement","Element","HTMLDocument","module","exports","literals","substitutions","query","console","log","length","Array","isArray","every","join","literal","index","String","createQuery","from","querySelectorAll"],"mappings":"AAKA,MAAMA,EAaN,WACE,MAAMC,EAqDCC,OAAOC,oBAAoBD,OAAOE,eAAeF,OAAOE,eAAeC,YAAYC,OAAOC,IAC9FA,EAAUC,QAAQ,QAAiC,MAAvBH,SAASE,IAAoD,mBAAvBF,SAASE,KAC5EE,IAAIF,GAAaA,EAAUG,OAAO,IAtD9BC,EAAgB,CACpBC,IAAKC,EACLC,IAAKC,GAEP,gBAAiBC,GACf,MAAMC,EAAc,GAOpB,OANAhB,EAAOiB,QAAQC,IACbC,EAAaH,EAAaE,EAAOE,EAAe,CAAEL,SAAAA,EAAUG,MAAAA,MAE9DjB,OAAOoB,QAAQX,GAAeO,QAAQ,EAAEK,EAAYC,MAClDJ,EAAaH,EAAaM,EAAYC,EAAY,CAAER,SAAAA,MAE/Cd,OAAOuB,iBAAiBT,EAAUC,IA3BzBS,GA+BpB,SAASN,EAAcH,EAAaU,EAAUC,EAAUC,GACtDZ,EAAYU,GAAY,GACxBV,EAAYU,GAAUG,MAAQF,EAASC,GAMzC,SAASR,GAAeL,SAAEA,EAAFG,MAAYA,IAClC,gBAAiBY,GAMf,OALAf,EAASE,QAAQc,IACfA,EAAQC,iBAAiBd,EAAQe,IAC/BH,EAAMG,EAASlB,OAGZA,GAIX,SAASH,GAAaG,SAAEA,IACtB,gBAAiBe,GAEf,OADAf,EAASE,QAAQa,GACVf,GAIX,SAASD,GAAaC,SAAEA,IACtB,gBAAiBe,GACf,OAAOf,EAASP,IAAIuB,GAAWD,EAAKC,KAuCxC,SAASG,EAAgBH,GACvB,OAAOA,aAAmBI,SAAWJ,aAAmBK,aAjG1DC,OAAOC,QAAU,SAAUC,KAAaC,GACtC,MAAMC,EA4ER,SAAsBF,EAAUC,GAE9B,OADAE,QAAQC,IAAI,OAAQJ,EAAUC,EAAeA,EAAcI,OAAQC,MAAMC,QAAQN,IAC7EK,MAAMC,QAAQP,IAAaA,EAASQ,MAAMb,GACrCK,EACEM,MAAMC,QAAQP,IAAaM,MAAMC,QAAQN,GAC1B,KAApBD,EAASS,QAAiBR,EAAcO,MAAMb,GACzCM,EAEAD,EAAS/B,IAAI,CAACyC,EAASC,KACpBD,GAAW,KAAOT,EAAcU,IAAU,KACjDF,QAAU,KAEc,iBAAbT,GAAyBA,aAAoBY,OACtDZ,OAzFKa,CAAYb,EAAUC,GACpC,GAAc,OAAVC,EAAgB,YACpB,GAAII,MAAMC,QAAQL,GAChB,OAAO1C,EAAY0C,GACd,CACL,MAAM1B,EAAW8B,MAAMQ,KAAKjD,SAASkD,iBAAiBb,IACtD,OAAO1B,EAAS6B,OAAS,EAAI7C,EAAYgB,GAAY"}